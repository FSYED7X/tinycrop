'use strict';

var Input = require('./Input.js');
var Listeners = require('./Listeners.js');
var Selection = require('./Selection.js');
var Rectangle = require('./Rectangle.js');

var SelectionLayer = function SelectionLayer(opts) {
  opts = opts || {};

  this.selection = Selection.create(opts);

  this.parent = opts.parent;
  this.context = opts.context;
  this.context.setLineDash = this.context.setLineDash || function () {};
  this.target = opts.target;

  var handleOpts = opts.handle || {};
  handleOpts.length = handleOpts.handleLength || 32;
  handleOpts.depth = handleOpts.depth || 3;
  handleOpts.size = handleOpts.size || handleOpts.length * 2;
  handleOpts.color = handleOpts.color || 'rgba(255, 255, 255, 1.0)';
  handleOpts.activeColor = handleOpts.activeColor || 'rgba(255, 0, 160, 1.0)';
  this.handleOpts = handleOpts;

  this.listeners = Listeners.create();

  this.input = Input.create(this.parent.canvas);

  this.activeRegion = null;
  this.downBounds = Rectangle.create(0, 0, 0, 0);

  this.input.on('down', this.onInputDown.bind(this));
  this.input.on('move', this.onInputMove.bind(this));
  this.input.on('up', this.onInputUpOrCancel.bind(this)).on('cancel', this.onInputUpOrCancel.bind(this));
};

SelectionLayer.create = function (opts) {
  return new SelectionLayer(opts);
};

SelectionLayer.prototype.onInputDown = function (e) {
  var hitRegion = this.findHitRegion(e);

  if (hitRegion) {
    e.source.preventDefault();
    this.activeRegion = hitRegion;
    this.setCursor(hitRegion);
    this.downBounds.copy(this.selection.bounds);
    this.listeners.notify('start', this.selection.region);
  }
};

SelectionLayer.prototype.onInputMove = function (e) {
  var activeRegion = this.activeRegion;

  if (!activeRegion) {
    var hitRegion = this.findHitRegion(e);
    if (hitRegion) {
      e.source.preventDefault();
      this.setCursor(hitRegion);
    } else {
      this.resetCursor();
    }
  } else {
    e.source.preventDefault();

    var selection = this.selection;
    var hasChanged = false;
    selection.bounds.copy(this.downBounds);

    if (activeRegion === 'move') {
      hasChanged = selection.moveBy(e.dx, e.dy);
      if (hasChanged) {
        this.listeners.notify('move', this.selection.region);
      }
    } else {
      var dir = activeRegion.substring(0, 2);
      var dx = dir[1] === 'w' ? -e.dx : e.dx;
      var dy = dir[0] === 'n' ? -e.dy : e.dy;
      hasChanged = selection.resizeBy(dx, dy, dir);
      if (hasChanged) {
        this.listeners.notify('resize', this.selection.region);
      }
    }

    if (hasChanged) {
      this.listeners.notify('change', this.selection.region);
    }
  }
};

SelectionLayer.prototype.onInputUpOrCancel = function (e) {
  e.source.preventDefault();
  if (this.activeRegion) {
    this.activeRegion = null;
    this.resetCursor();
    this.listeners.notify('end', this.selection.region);
  }
};

SelectionLayer.prototype.findHitRegion = function (point) {
  var hitRegion = null;
  var closest = Number.MAX_VALUE;

  var d = this.isWithinNorthWestHandle(point);
  if (d !== false && d < closest) {
    closest = d;
    hitRegion = 'nw-resize';
  }

  d = this.isWithinNorthEastHandle(point);
  if (d !== false && d < closest) {
    closest = d;
    hitRegion = 'ne-resize';
  }

  d = this.isWithinSouthWestHandle(point);
  if (d !== false && d < closest) {
    closest = d;
    hitRegion = 'sw-resize';
  }

  d = this.isWithinSouthEastHandle(point);
  if (d !== false && d < closest) {
    closest = d;
    hitRegion = 'se-resize';
  }

  if (hitRegion) {
    return hitRegion;
  } else if (this.isWithinBounds(point)) {
    return 'move';
  } else {
    return null;
  }
};

SelectionLayer.prototype.on = function (type, fn) {
  this.listeners.on(type, fn);
  return this;
};

SelectionLayer.prototype.off = function (type, fn) {
  this.listeners.off(type, fn);
  return this;
};

SelectionLayer.prototype.setCursor = function (type) {
  if (this.parent.canvas.style.cursor !== type) {
    this.parent.canvas.style.cursor = type;
  }
};

SelectionLayer.prototype.resetCursor = function () {
  this.setCursor('auto');
};

SelectionLayer.prototype.isWithinRadius = function (ax, ay, bx, by, r) {
  var tsq = r * r;
  var dx = ax - bx;
  var dy = ay - by;
  var dsq = dx * dx + dy * dy;
  return dsq < tsq ? dsq : false;
};

SelectionLayer.prototype.isWithinNorthWestHandle = function (point) {
  return this.isWithinRadius(point.x, point.y, this.selection.left, this.selection.top, this.getHandleRadius());
};

SelectionLayer.prototype.isWithinNorthEastHandle = function (point) {
  return this.isWithinRadius(point.x, point.y, this.selection.right, this.selection.top, this.getHandleRadius());
};

SelectionLayer.prototype.isWithinSouthWestHandle = function (point) {
  return this.isWithinRadius(point.x, point.y, this.selection.left, this.selection.bottom, this.getHandleRadius());
};

SelectionLayer.prototype.isWithinSouthEastHandle = function (point) {
  return this.isWithinRadius(point.x, point.y, this.selection.right, this.selection.bottom, this.getHandleRadius());
};

SelectionLayer.prototype.isWithinBounds = function (point) {
  return this.selection.isInside(point);
};

SelectionLayer.prototype.getHandleRadius = function () {
  return this.handleOpts.size / 2;
};

SelectionLayer.prototype.onImageLoad = function () {
  this.autoSizeRegionAndNotify();
};

SelectionLayer.prototype.setAspectRatio = function (aspectRatio) {
  this.selection.aspectRatio = aspectRatio;
  this.autoSizeRegionAndNotify();
};

SelectionLayer.prototype.autoSizeRegionAndNotify = function () {
  var hasChanged = this.selection.autoSizeRegion();
  if (hasChanged) {
    this.listeners.notify('change', this.selection.region);
  }
};

SelectionLayer.prototype.revalidate = function () {
  this.selection.updateBoundsFromRegion();
};

SelectionLayer.prototype.paint = function () {
  this.selection.boundsPx.copy(this.selection.bounds).round();

  this.paintOutside();
  this.paintInside();
};

SelectionLayer.prototype.paintOutside = function () {
  var bounds = this.selection.boundsPx;
  var g = this.context;
  var target = this.target;

  var tl = target.bounds.x;
  var tt = target.bounds.y;
  var tw = target.bounds.width;
  var tr = target.bounds.right;
  var tb = target.bounds.bottom;

  var bl = bounds.x;
  var bt = bounds.y;
  var bh = bounds.height;
  var br = bounds.right;
  var bb = bounds.bottom;

  g.fillStyle = 'rgba(0, 0, 0, 0.5)';
  g.fillRect(tl, tt, tw, bt - tt);
  g.fillRect(tl, bt, bl - tl, bh);
  g.fillRect(br, bt, tr - br, bh);
  g.fillRect(tl, bb, tw, tb - bb);
};

SelectionLayer.prototype.paintInside = function () {
  var g = this.context;
  var bounds = this.selection.boundsPx;
  var activeRegion = this.activeRegion;
  var opts = this.handleOpts;

  var lengthWidth = Math.min(opts.length, bounds.width * 0.5);
  var lengthHeight = Math.min(opts.length, bounds.height * 0.5);
  var depth = opts.depth;
  var color = opts.color;
  var activeColor = opts.activeColor;
  var length = 0; // TODO: CHECK

  // Sides
  g.fillStyle = 'rgba(255, 255, 255, 0.3)';
  g.fillRect(bounds.x + length, bounds.y, bounds.width - 2 * length, depth);
  g.fillRect(bounds.x + length, bounds.bottom - depth, bounds.width - 2 * length, depth);
  g.fillRect(bounds.x, bounds.y + length, depth, bounds.height - 2 * length);
  g.fillRect(bounds.right - depth, bounds.y + length, depth, bounds.height - 2 * length);

  // Handles
  var isMoveRegion = activeRegion === 'move';

  g.fillStyle = isMoveRegion || activeRegion === 'nw-resize' ? activeColor : color;
  g.fillRect(bounds.x, bounds.y, lengthWidth, depth);
  g.fillRect(bounds.x, bounds.y + depth, depth, lengthHeight - depth);

  g.fillStyle = isMoveRegion || activeRegion === 'ne-resize' ? activeColor : color;
  g.fillRect(bounds.right - lengthWidth, bounds.y, lengthWidth, depth);
  g.fillRect(bounds.right - depth, bounds.y + depth, depth, lengthHeight - depth);

  g.fillStyle = isMoveRegion || activeRegion === 'sw-resize' ? activeColor : color;
  g.fillRect(bounds.x, bounds.bottom - depth, lengthWidth, depth);
  g.fillRect(bounds.x, bounds.bottom - lengthHeight, depth, lengthHeight - depth);

  g.fillStyle = isMoveRegion || activeRegion === 'se-resize' ? activeColor : color;
  g.fillRect(bounds.right - lengthWidth, bounds.bottom - depth, lengthWidth, depth);
  g.fillRect(bounds.right - depth, bounds.bottom - lengthHeight, depth, lengthHeight - depth);

  // Guides
  g.strokeStyle = 'rgba(255, 255, 255, 0.6)';
  g.setLineDash([2, 3]);
  g.lineWidth = 1;
  g.beginPath();
  var bw3 = bounds.width / 3;
  var bh3 = bounds.height / 3;
  g.moveTo(bounds.x + bw3, bounds.y);
  g.lineTo(bounds.x + bw3, bounds.y + bounds.height);
  g.moveTo(bounds.x + 2 * bw3, bounds.y);
  g.lineTo(bounds.x + 2 * bw3, bounds.y + bounds.height);
  g.moveTo(bounds.x, bounds.y + bh3);
  g.lineTo(bounds.x + bounds.width, bounds.y + bh3);
  g.moveTo(bounds.x, bounds.y + 2 * bh3);
  g.lineTo(bounds.x + bounds.width, bounds.y + 2 * bh3);
  g.stroke();
  g.closePath();
};

module.exports = SelectionLayer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9TZWxlY3Rpb25MYXllci5qcyJdLCJuYW1lcyI6WyJJbnB1dCIsInJlcXVpcmUiLCJMaXN0ZW5lcnMiLCJTZWxlY3Rpb24iLCJSZWN0YW5nbGUiLCJTZWxlY3Rpb25MYXllciIsIm9wdHMiLCJzZWxlY3Rpb24iLCJjcmVhdGUiLCJwYXJlbnQiLCJjb250ZXh0Iiwic2V0TGluZURhc2giLCJ0YXJnZXQiLCJoYW5kbGVPcHRzIiwiaGFuZGxlIiwibGVuZ3RoIiwiaGFuZGxlTGVuZ3RoIiwiZGVwdGgiLCJzaXplIiwiY29sb3IiLCJhY3RpdmVDb2xvciIsImxpc3RlbmVycyIsImlucHV0IiwiY2FudmFzIiwiYWN0aXZlUmVnaW9uIiwiZG93bkJvdW5kcyIsIm9uIiwib25JbnB1dERvd24iLCJiaW5kIiwib25JbnB1dE1vdmUiLCJvbklucHV0VXBPckNhbmNlbCIsInByb3RvdHlwZSIsImUiLCJoaXRSZWdpb24iLCJmaW5kSGl0UmVnaW9uIiwic291cmNlIiwicHJldmVudERlZmF1bHQiLCJzZXRDdXJzb3IiLCJjb3B5IiwiYm91bmRzIiwibm90aWZ5IiwicmVnaW9uIiwicmVzZXRDdXJzb3IiLCJoYXNDaGFuZ2VkIiwibW92ZUJ5IiwiZHgiLCJkeSIsImRpciIsInN1YnN0cmluZyIsInJlc2l6ZUJ5IiwicG9pbnQiLCJjbG9zZXN0IiwiTnVtYmVyIiwiTUFYX1ZBTFVFIiwiZCIsImlzV2l0aGluTm9ydGhXZXN0SGFuZGxlIiwiaXNXaXRoaW5Ob3J0aEVhc3RIYW5kbGUiLCJpc1dpdGhpblNvdXRoV2VzdEhhbmRsZSIsImlzV2l0aGluU291dGhFYXN0SGFuZGxlIiwiaXNXaXRoaW5Cb3VuZHMiLCJ0eXBlIiwiZm4iLCJvZmYiLCJzdHlsZSIsImN1cnNvciIsImlzV2l0aGluUmFkaXVzIiwiYXgiLCJheSIsImJ4IiwiYnkiLCJyIiwidHNxIiwiZHNxIiwieCIsInkiLCJsZWZ0IiwidG9wIiwiZ2V0SGFuZGxlUmFkaXVzIiwicmlnaHQiLCJib3R0b20iLCJpc0luc2lkZSIsIm9uSW1hZ2VMb2FkIiwiYXV0b1NpemVSZWdpb25BbmROb3RpZnkiLCJzZXRBc3BlY3RSYXRpbyIsImFzcGVjdFJhdGlvIiwiYXV0b1NpemVSZWdpb24iLCJyZXZhbGlkYXRlIiwidXBkYXRlQm91bmRzRnJvbVJlZ2lvbiIsInBhaW50IiwiYm91bmRzUHgiLCJyb3VuZCIsInBhaW50T3V0c2lkZSIsInBhaW50SW5zaWRlIiwiZyIsInRsIiwidHQiLCJ0dyIsIndpZHRoIiwidHIiLCJ0YiIsImJsIiwiYnQiLCJiaCIsImhlaWdodCIsImJyIiwiYmIiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImxlbmd0aFdpZHRoIiwiTWF0aCIsIm1pbiIsImxlbmd0aEhlaWdodCIsImlzTW92ZVJlZ2lvbiIsInN0cm9rZVN0eWxlIiwibGluZVdpZHRoIiwiYmVnaW5QYXRoIiwiYnczIiwiYmgzIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiY2xvc2VQYXRoIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxRQUFRQyxRQUFRLFlBQVIsQ0FBWjtBQUNBLElBQUlDLFlBQVlELFFBQVEsZ0JBQVIsQ0FBaEI7QUFDQSxJQUFJRSxZQUFZRixRQUFRLGdCQUFSLENBQWhCO0FBQ0EsSUFBSUcsWUFBWUgsUUFBUSxnQkFBUixDQUFoQjs7QUFFQSxJQUFJSSxpQkFBaUIsU0FBakJBLGNBQWlCLENBQVVDLElBQVYsRUFBZ0I7QUFDbkNBLFNBQU9BLFFBQVEsRUFBZjs7QUFFQSxPQUFLQyxTQUFMLEdBQWlCSixVQUFVSyxNQUFWLENBQWlCRixJQUFqQixDQUFqQjs7QUFFQSxPQUFLRyxNQUFMLEdBQWNILEtBQUtHLE1BQW5CO0FBQ0EsT0FBS0MsT0FBTCxHQUFlSixLQUFLSSxPQUFwQjtBQUNBLE9BQUtBLE9BQUwsQ0FBYUMsV0FBYixHQUEyQixLQUFLRCxPQUFMLENBQWFDLFdBQWIsSUFBNEIsWUFBWSxDQUFFLENBQXJFO0FBQ0EsT0FBS0MsTUFBTCxHQUFjTixLQUFL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bEMsT0FBTzBELEtBQTNCLEVBQWtDMUQsT0FBT21DLENBQVAsR0FBVzJDLEdBQTdDO0FBQ0F4QixJQUFFeUIsTUFBRixDQUFTL0UsT0FBT2tDLENBQWhCLEVBQW1CbEMsT0FBT21DLENBQVAsR0FBVyxJQUFJMkMsR0FBbEM7QUFDQXhCLElBQUUwQixNQUFGLENBQVNoRixPQUFPa0MsQ0FBUCxHQUFXbEMsT0FBTzBELEtBQTNCLEVBQWtDMUQsT0FBT21DLENBQVAsR0FBVyxJQUFJMkMsR0FBakQ7QUFDQXhCLElBQUUyQixNQUFGO0FBQ0EzQixJQUFFNEIsU0FBRjtBQUNELENBeEREOztBQTBEQUMsT0FBT0MsT0FBUCxHQUFpQnRILGNBQWpCIiwiZmlsZSI6IlNlbGVjdGlvbkxheWVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIElucHV0ID0gcmVxdWlyZSgnLi9JbnB1dC5qcycpXG52YXIgTGlzdGVuZXJzID0gcmVxdWlyZSgnLi9MaXN0ZW5lcnMuanMnKVxudmFyIFNlbGVjdGlvbiA9IHJlcXVpcmUoJy4vU2VsZWN0aW9uLmpzJylcbnZhciBSZWN0YW5nbGUgPSByZXF1aXJlKCcuL1JlY3RhbmdsZS5qcycpXG5cbnZhciBTZWxlY3Rpb25MYXllciA9IGZ1bmN0aW9uIChvcHRzKSB7XG4gIG9wdHMgPSBvcHRzIHx8IHt9XG5cbiAgdGhpcy5zZWxlY3Rpb24gPSBTZWxlY3Rpb24uY3JlYXRlKG9wdHMpXG5cbiAgdGhpcy5wYXJlbnQgPSBvcHRzLnBhcmVudFxuICB0aGlzLmNvbnRleHQgPSBvcHRzLmNvbnRleHRcbiAgdGhpcy5jb250ZXh0LnNldExpbmVEYXNoID0gdGhpcy5jb250ZXh0LnNldExpbmVEYXNoIHx8IGZ1bmN0aW9uICgpIHt9XG4gIHRoaXMudGFyZ2V0ID0gb3B0cy50YXJnZXRcblxuICB2YXIgaGFuZGxlT3B0cyA9IG9wdHMuaGFuZGxlIHx8IHt9XG4gIGhhbmRsZU9wdHMubGVuZ3RoID0gaGFuZGxlT3B0cy5oYW5kbGVMZW5ndGggfHwgMzJcbiAgaGFuZGxlT3B0cy5kZXB0aCA9IGhhbmRsZU9wdHMuZGVwdGggfHwgM1xuICBoYW5kbGVPcHRzLnNpemUgPSBoYW5kbGVPcHRzLnNpemUgfHwgaGFuZGxlT3B0cy5sZW5ndGggKiAyXG4gIGhhbmRsZU9wdHMuY29sb3IgPSBoYW5kbGVPcHRzLmNvbG9yIHx8ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDEuMCknXG4gIGhhbmRsZU9wdHMuYWN0aXZlQ29sb3IgPSBoYW5kbGVPcHRzLmFjdGl2ZUNvbG9yIHx8ICdyZ2JhKDI1NSwgMCwgMTYwLCAxLjApJ1xuICB0aGlzLmhhbmRsZU9wdHMgPSBoYW5kbGVPcHRzXG5cbiAgdGhpcy5saXN0ZW5lcnMgPSBMaXN0ZW5lcnMuY3JlYXRlKClcblxuICB0aGlzLmlucHV0ID0gSW5wdXQuY3JlYXRlKHRoaXMucGFyZW50LmNhbnZhcylcblxuICB0aGlzLmFjdGl2ZVJlZ2lvbiA9IG51bGxcbiAgdGhpcy5kb3duQm91bmRzID0gUmVjdGFuZ2xlLmNyZWF0ZSgwLCAwLCAwLCAwKVxuXG4gIHRoaXMuaW5wdXQub24oJ2Rvd24nLCB0aGlzLm9uSW5wdXREb3duLmJpbmQodGhpcykpXG4gIHRoaXMuaW5wdXQub24oJ21vdmUnLCB0aGlzLm9uSW5wdXRNb3ZlLmJpbmQodGhpcykpXG4gIHRoaXMuaW5wdXRcbiAgICAub24oJ3VwJywgdGhpcy5vbklucHV0VXBPckNhbmNlbC5iaW5kKHRoaXMpKVxuICAgIC5vbignY2FuY2VsJywgdGhpcy5vbklucHV0VXBPckNhbmNlbC5iaW5kKHRoaXMpKVxufVxuXG5TZWxlY3Rpb25MYXllci5jcmVhdGUgPSBmdW5jdGlvbiAob3B0cykge1xuICByZXR1cm4gbmV3IFNlbGVjdGlvbkxheWVyKG9wdHMpXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5vbklucHV0RG93biA9IGZ1bmN0aW9uIChlKSB7XG4gIHZhciBoaXRSZWdpb24gPSB0aGlzLmZpbmRIaXRSZWdpb24oZSlcblxuICBpZiAoaGl0UmVnaW9uKSB7XG4gICAgZS5zb3VyY2UucHJldmVudERlZmF1bHQoKVxuICAgIHRoaXMuYWN0aXZlUmVnaW9uID0gaGl0UmVnaW9uXG4gICAgdGhpcy5zZXRDdXJzb3IoaGl0UmVnaW9uKVxuICAgIHRoaXMuZG93bkJvdW5kcy5jb3B5KHRoaXMuc2VsZWN0aW9uLmJvdW5kcylcbiAgICB0aGlzLmxpc3RlbmVycy5ub3RpZnkoJ3N0YXJ0JywgdGhpcy5zZWxlY3Rpb24ucmVnaW9uKVxuICB9XG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5vbklucHV0TW92ZSA9IGZ1bmN0aW9uIChlKSB7XG4gIHZhciBhY3RpdmVSZWdpb24gPSB0aGlzLmFjdGl2ZVJlZ2lvblxuXG4gIGlmICghYWN0aXZlUmVnaW9uKSB7XG4gICAgdmFyIGhpdFJlZ2lvbiA9IHRoaXMuZmluZEhpdFJlZ2lvbihlKVxuICAgIGlmIChoaXRSZWdpb24pIHtcbiAgICAgIGUuc291cmNlLnByZXZlbnREZWZhdWx0KClcbiAgICAgIHRoaXMuc2V0Q3Vyc29yKGhpdFJlZ2lvbilcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZXNldEN1cnNvcigpXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGUuc291cmNlLnByZXZlbnREZWZhdWx0KClcblxuICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvblxuICAgIHZhciBoYXNDaGFuZ2VkID0gZmFsc2VcbiAgICBzZWxlY3Rpb24uYm91bmRzLmNvcHkodGhpcy5kb3duQm91bmRzKVxuXG4gICAgaWYgKGFjdGl2ZVJlZ2lvbiA9PT0gJ21vdmUnKSB7XG4gICAgICBoYXNDaGFuZ2VkID0gc2VsZWN0aW9uLm1vdmVCeShlLmR4LCBlLmR5KVxuICAgICAgaWYgKGhhc0NoYW5nZWQpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMubm90aWZ5KCdtb3ZlJywgdGhpcy5zZWxlY3Rpb24ucmVnaW9uKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgZGlyID0gYWN0aXZlUmVnaW9uLnN1YnN0cmluZygwLCAyKVxuICAgICAgdmFyIGR4ID0gZGlyWzFdID09PSAndycgPyAtZS5keCA6IGUuZHhcbiAgICAgIHZhciBkeSA9IGRpclswXSA9PT0gJ24nID8gLWUuZHkgOiBlLmR5XG4gICAgICBoYXNDaGFuZ2VkID0gc2VsZWN0aW9uLnJlc2l6ZUJ5KGR4LCBkeSwgZGlyKVxuICAgICAgaWYgKGhhc0NoYW5nZWQpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMubm90aWZ5KCdyZXNpemUnLCB0aGlzLnNlbGVjdGlvbi5yZWdpb24pXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGhhc0NoYW5nZWQpIHtcbiAgICAgIHRoaXMubGlzdGVuZXJzLm5vdGlmeSgnY2hhbmdlJywgdGhpcy5zZWxlY3Rpb24ucmVnaW9uKVxuICAgIH1cbiAgfVxufVxuXG5TZWxlY3Rpb25MYXllci5wcm90b3R5cGUub25JbnB1dFVwT3JDYW5jZWwgPSBmdW5jdGlvbiAoZSkge1xuICBlLnNvdXJjZS5wcmV2ZW50RGVmYXVsdCgpXG4gIGlmICh0aGlzLmFjdGl2ZVJlZ2lvbikge1xuICAgIHRoaXMuYWN0aXZlUmVnaW9uID0gbnVsbFxuICAgIHRoaXMucmVzZXRDdXJzb3IoKVxuICAgIHRoaXMubGlzdGVuZXJzLm5vdGlmeSgnZW5kJywgdGhpcy5zZWxlY3Rpb24ucmVnaW9uKVxuICB9XG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5maW5kSGl0UmVnaW9uID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gIHZhciBoaXRSZWdpb24gPSBudWxsXG4gIHZhciBjbG9zZXN0ID0gTnVtYmVyLk1BWF9WQUxVRVxuXG4gIHZhciBkID0gdGhpcy5pc1dpdGhpbk5vcnRoV2VzdEhhbmRsZShwb2ludClcbiAgaWYgKGQgIT09IGZhbHNlICYmIGQgPCBjbG9zZXN0KSB7XG4gICAgY2xvc2VzdCA9IGRcbiAgICBoaXRSZWdpb24gPSAnbnctcmVzaXplJ1xuICB9XG5cbiAgZCA9IHRoaXMuaXNXaXRoaW5Ob3J0aEVhc3RIYW5kbGUocG9pbnQpXG4gIGlmIChkICE9PSBmYWxzZSAmJiBkIDwgY2xvc2VzdCkge1xuICAgIGNsb3Nlc3QgPSBkXG4gICAgaGl0UmVnaW9uID0gJ25lLXJlc2l6ZSdcbiAgfVxuXG4gIGQgPSB0aGlzLmlzV2l0aGluU291dGhXZXN0SGFuZGxlKHBvaW50KVxuICBpZiAoZCAhPT0gZmFsc2UgJiYgZCA8IGNsb3Nlc3QpIHtcbiAgICBjbG9zZXN0ID0gZFxuICAgIGhpdFJlZ2lvbiA9ICdzdy1yZXNpemUnXG4gIH1cblxuICBkID0gdGhpcy5pc1dpdGhpblNvdXRoRWFzdEhhbmRsZShwb2ludClcbiAgaWYgKGQgIT09IGZhbHNlICYmIGQgPCBjbG9zZXN0KSB7XG4gICAgY2xvc2VzdCA9IGRcbiAgICBoaXRSZWdpb24gPSAnc2UtcmVzaXplJ1xuICB9XG5cbiAgaWYgKGhpdFJlZ2lvbikge1xuICAgIHJldHVybiBoaXRSZWdpb25cbiAgfSBlbHNlIGlmICh0aGlzLmlzV2l0aGluQm91bmRzKHBvaW50KSkge1xuICAgIHJldHVybiAnbW92ZSdcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uICh0eXBlLCBmbikge1xuICB0aGlzLmxpc3RlbmVycy5vbih0eXBlLCBmbilcbiAgcmV0dXJuIHRoaXNcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uICh0eXBlLCBmbikge1xuICB0aGlzLmxpc3RlbmVycy5vZmYodHlwZSwgZm4pXG4gIHJldHVybiB0aGlzXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5zZXRDdXJzb3IgPSBmdW5jdGlvbiAodHlwZSkge1xuICBpZiAodGhpcy5wYXJlbnQuY2FudmFzLnN0eWxlLmN1cnNvciAhPT0gdHlwZSkge1xuICAgIHRoaXMucGFyZW50LmNhbnZhcy5zdHlsZS5jdXJzb3IgPSB0eXBlXG4gIH1cbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLnJlc2V0Q3Vyc29yID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnNldEN1cnNvcignYXV0bycpXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5pc1dpdGhpblJhZGl1cyA9IGZ1bmN0aW9uIChheCwgYXksIGJ4LCBieSwgcikge1xuICB2YXIgdHNxID0gciAqIHJcbiAgdmFyIGR4ID0gYXggLSBieFxuICB2YXIgZHkgPSBheSAtIGJ5XG4gIHZhciBkc3EgPSBkeCAqIGR4ICsgZHkgKiBkeVxuICByZXR1cm4gKGRzcSA8IHRzcSkgPyBkc3EgOiBmYWxzZVxufVxuXG5TZWxlY3Rpb25MYXllci5wcm90b3R5cGUuaXNXaXRoaW5Ob3J0aFdlc3RIYW5kbGUgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgcmV0dXJuIHRoaXMuaXNXaXRoaW5SYWRpdXMocG9pbnQueCwgcG9pbnQueSwgdGhpcy5zZWxlY3Rpb24ubGVmdCwgdGhpcy5zZWxlY3Rpb24udG9wLCB0aGlzLmdldEhhbmRsZVJhZGl1cygpKVxufVxuXG5TZWxlY3Rpb25MYXllci5wcm90b3R5cGUuaXNXaXRoaW5Ob3J0aEVhc3RIYW5kbGUgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgcmV0dXJuIHRoaXMuaXNXaXRoaW5SYWRpdXMocG9pbnQueCwgcG9pbnQueSwgdGhpcy5zZWxlY3Rpb24ucmlnaHQsIHRoaXMuc2VsZWN0aW9uLnRvcCwgdGhpcy5nZXRIYW5kbGVSYWRpdXMoKSlcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLmlzV2l0aGluU291dGhXZXN0SGFuZGxlID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gIHJldHVybiB0aGlzLmlzV2l0aGluUmFkaXVzKHBvaW50LngsIHBvaW50LnksIHRoaXMuc2VsZWN0aW9uLmxlZnQsIHRoaXMuc2VsZWN0aW9uLmJvdHRvbSwgdGhpcy5nZXRIYW5kbGVSYWRpdXMoKSlcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLmlzV2l0aGluU291dGhFYXN0SGFuZGxlID0gZnVuY3Rpb24gKHBvaW50KSB7XG4gIHJldHVybiB0aGlzLmlzV2l0aGluUmFkaXVzKHBvaW50LngsIHBvaW50LnksIHRoaXMuc2VsZWN0aW9uLnJpZ2h0LCB0aGlzLnNlbGVjdGlvbi5ib3R0b20sIHRoaXMuZ2V0SGFuZGxlUmFkaXVzKCkpXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5pc1dpdGhpbkJvdW5kcyA9IGZ1bmN0aW9uIChwb2ludCkge1xuICByZXR1cm4gdGhpcy5zZWxlY3Rpb24uaXNJbnNpZGUocG9pbnQpXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5nZXRIYW5kbGVSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmhhbmRsZU9wdHMuc2l6ZSAvIDJcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLm9uSW1hZ2VMb2FkID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmF1dG9TaXplUmVnaW9uQW5kTm90aWZ5KClcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLnNldEFzcGVjdFJhdGlvID0gZnVuY3Rpb24gKGFzcGVjdFJhdGlvKSB7XG4gIHRoaXMuc2VsZWN0aW9uLmFzcGVjdFJhdGlvID0gYXNwZWN0UmF0aW9cbiAgdGhpcy5hdXRvU2l6ZVJlZ2lvbkFuZE5vdGlmeSgpXG59XG5cblNlbGVjdGlvbkxheWVyLnByb3RvdHlwZS5hdXRvU2l6ZVJlZ2lvbkFuZE5vdGlmeSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGhhc0NoYW5nZWQgPSB0aGlzLnNlbGVjdGlvbi5hdXRvU2l6ZVJlZ2lvbigpXG4gIGlmIChoYXNDaGFuZ2VkKSB7XG4gICAgdGhpcy5saXN0ZW5lcnMubm90aWZ5KCdjaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbi5yZWdpb24pXG4gIH1cbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLnJldmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuc2VsZWN0aW9uLnVwZGF0ZUJvdW5kc0Zyb21SZWdpb24oKVxufVxuXG5TZWxlY3Rpb25MYXllci5wcm90b3R5cGUucGFpbnQgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuc2VsZWN0aW9uLmJvdW5kc1B4LmNvcHkodGhpcy5zZWxlY3Rpb24uYm91bmRzKS5yb3VuZCgpXG5cbiAgdGhpcy5wYWludE91dHNpZGUoKVxuICB0aGlzLnBhaW50SW5zaWRlKClcbn1cblxuU2VsZWN0aW9uTGF5ZXIucHJvdG90eXBlLnBhaW50T3V0c2lkZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvdW5kcyA9IHRoaXMuc2VsZWN0aW9uLmJvdW5kc1B4XG4gIHZhciBnID0gdGhpcy5jb250ZXh0XG4gIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldFxuXG4gIHZhciB0bCA9IHRhcmdldC5ib3VuZHMueFxuICB2YXIgdHQgPSB0YXJnZXQuYm91bmRzLnlcbiAgdmFyIHR3ID0gdGFyZ2V0LmJvdW5kcy53aWR0aFxuICB2YXIgdHIgPSB0YXJnZXQuYm91bmRzLnJpZ2h0XG4gIHZhciB0YiA9IHRhcmdldC5ib3VuZHMuYm90dG9tXG5cbiAgdmFyIGJsID0gYm91bmRzLnhcbiAgdmFyIGJ0ID0gYm91bmRzLnlcbiAgdmFyIGJoID0gYm91bmRzLmhlaWdodFxuICB2YXIgYnIgPSBib3VuZHMucmlnaHRcbiAgdmFyIGJiID0gYm91bmRzLmJvdHRvbVxuXG4gIGcuZmlsbFN0eWxlID0gJ3JnYmEoMCwgMCwgMCwgMC41KSdcbiAgZy5maWxsUmVjdCh0bCwgdHQsIHR3LCBidCAtIHR0KVxuICBnLmZpbGxSZWN0KHRsLCBidCwgYmwgLSB0bCwgYmgpXG4gIGcuZmlsbFJlY3QoYnIsIGJ0LCB0ciAtIGJyLCBiaClcbiAgZy5maWxsUmVjdCh0bCwgYmIsIHR3LCB0YiAtIGJiKVxufVxuXG5TZWxlY3Rpb25MYXllci5wcm90b3R5cGUucGFpbnRJbnNpZGUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBnID0gdGhpcy5jb250ZXh0XG4gIHZhciBib3VuZHMgPSB0aGlzLnNlbGVjdGlvbi5ib3VuZHNQeFxuICB2YXIgYWN0aXZlUmVnaW9uID0gdGhpcy5hY3RpdmVSZWdpb25cbiAgdmFyIG9wdHMgPSB0aGlzLmhhbmRsZU9wdHNcblxuICB2YXIgbGVuZ3RoV2lkdGggPSBNYXRoLm1pbihvcHRzLmxlbmd0aCwgYm91bmRzLndpZHRoICogMC41KVxuICB2YXIgbGVuZ3RoSGVpZ2h0ID0gTWF0aC5taW4ob3B0cy5sZW5ndGgsIGJvdW5kcy5oZWlnaHQgKiAwLjUpXG4gIHZhciBkZXB0aCA9IG9wdHMuZGVwdGhcbiAgdmFyIGNvbG9yID0gb3B0cy5jb2xvclxuICB2YXIgYWN0aXZlQ29sb3IgPSBvcHRzLmFjdGl2ZUNvbG9yXG4gIHZhciBsZW5ndGggPSAwIC8vIFRPRE86IENIRUNLXG5cbiAgLy8gU2lkZXNcbiAgZy5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpJ1xuICBnLmZpbGxSZWN0KGJvdW5kcy54ICsgbGVuZ3RoLCBib3VuZHMueSwgYm91bmRzLndpZHRoIC0gMiAqIGxlbmd0aCwgZGVwdGgpXG4gIGcuZmlsbFJlY3QoYm91bmRzLnggKyBsZW5ndGgsIGJvdW5kcy5ib3R0b20gLSBkZXB0aCwgYm91bmRzLndpZHRoIC0gMiAqIGxlbmd0aCwgZGVwdGgpXG4gIGcuZmlsbFJlY3QoYm91bmRzLngsIGJvdW5kcy55ICsgbGVuZ3RoLCBkZXB0aCwgYm91bmRzLmhlaWdodCAtIDIgKiBsZW5ndGgpXG4gIGcuZmlsbFJlY3QoYm91bmRzLnJpZ2h0IC0gZGVwdGgsIGJvdW5kcy55ICsgbGVuZ3RoLCBkZXB0aCwgYm91bmRzLmhlaWdodCAtIDIgKiBsZW5ndGgpXG5cbiAgLy8gSGFuZGxlc1xuICB2YXIgaXNNb3ZlUmVnaW9uID0gYWN0aXZlUmVnaW9uID09PSAnbW92ZSdcblxuICBnLmZpbGxTdHlsZSA9IGlzTW92ZVJlZ2lvbiB8fCBhY3RpdmVSZWdpb24gPT09ICdudy1yZXNpemUnID8gYWN0aXZlQ29sb3IgOiBjb2xvclxuICBnLmZpbGxSZWN0KGJvdW5kcy54LCBib3VuZHMueSwgbGVuZ3RoV2lkdGgsIGRlcHRoKVxuICBnLmZpbGxSZWN0KGJvdW5kcy54LCBib3VuZHMueSArIGRlcHRoLCBkZXB0aCwgbGVuZ3RoSGVpZ2h0IC0gZGVwdGgpXG5cbiAgZy5maWxsU3R5bGUgPSBpc01vdmVSZWdpb24gfHwgYWN0aXZlUmVnaW9uID09PSAnbmUtcmVzaXplJyA/IGFjdGl2ZUNvbG9yIDogY29sb3JcbiAgZy5maWxsUmVjdChib3VuZHMucmlnaHQgLSBsZW5ndGhXaWR0aCwgYm91bmRzLnksIGxlbmd0aFdpZHRoLCBkZXB0aClcbiAgZy5maWxsUmVjdChib3VuZHMucmlnaHQgLSBkZXB0aCwgYm91bmRzLnkgKyBkZXB0aCwgZGVwdGgsIGxlbmd0aEhlaWdodCAtIGRlcHRoKVxuXG4gIGcuZmlsbFN0eWxlID0gaXNNb3ZlUmVnaW9uIHx8IGFjdGl2ZVJlZ2lvbiA9PT0gJ3N3LXJlc2l6ZScgPyBhY3RpdmVDb2xvciA6IGNvbG9yXG4gIGcuZmlsbFJlY3QoYm91bmRzLngsIGJvdW5kcy5ib3R0b20gLSBkZXB0aCwgbGVuZ3RoV2lkdGgsIGRlcHRoKVxuICBnLmZpbGxSZWN0KGJvdW5kcy54LCBib3VuZHMuYm90dG9tIC0gbGVuZ3RoSGVpZ2h0LCBkZXB0aCwgbGVuZ3RoSGVpZ2h0IC0gZGVwdGgpXG5cbiAgZy5maWxsU3R5bGUgPSBpc01vdmVSZWdpb24gfHwgYWN0aXZlUmVnaW9uID09PSAnc2UtcmVzaXplJyA/IGFjdGl2ZUNvbG9yIDogY29sb3JcbiAgZy5maWxsUmVjdChib3VuZHMucmlnaHQgLSBsZW5ndGhXaWR0aCwgYm91bmRzLmJvdHRvbSAtIGRlcHRoLCBsZW5ndGhXaWR0aCwgZGVwdGgpXG4gIGcuZmlsbFJlY3QoYm91bmRzLnJpZ2h0IC0gZGVwdGgsIGJvdW5kcy5ib3R0b20gLSBsZW5ndGhIZWlnaHQsIGRlcHRoLCBsZW5ndGhIZWlnaHQgLSBkZXB0aClcblxuICAvLyBHdWlkZXNcbiAgZy5zdHJva2VTdHlsZSA9ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknXG4gIGcuc2V0TGluZURhc2goWzIsIDNdKVxuICBnLmxpbmVXaWR0aCA9IDFcbiAgZy5iZWdpblBhdGgoKVxuICB2YXIgYnczID0gYm91bmRzLndpZHRoIC8gM1xuICB2YXIgYmgzID0gYm91bmRzLmhlaWdodCAvIDNcbiAgZy5tb3ZlVG8oYm91bmRzLnggKyBidzMsIGJvdW5kcy55KVxuICBnLmxpbmVUbyhib3VuZHMueCArIGJ3MywgYm91bmRzLnkgKyBib3VuZHMuaGVpZ2h0KVxuICBnLm1vdmVUbyhib3VuZHMueCArIDIgKiBidzMsIGJvdW5kcy55KVxuICBnLmxpbmVUbyhib3VuZHMueCArIDIgKiBidzMsIGJvdW5kcy55ICsgYm91bmRzLmhlaWdodClcbiAgZy5tb3ZlVG8oYm91bmRzLngsIGJvdW5kcy55ICsgYmgzKVxuICBnLmxpbmVUbyhib3VuZHMueCArIGJvdW5kcy53aWR0aCwgYm91bmRzLnkgKyBiaDMpXG4gIGcubW92ZVRvKGJvdW5kcy54LCBib3VuZHMueSArIDIgKiBiaDMpXG4gIGcubGluZVRvKGJvdW5kcy54ICsgYm91bmRzLndpZHRoLCBib3VuZHMueSArIDIgKiBiaDMpXG4gIGcuc3Ryb2tlKClcbiAgZy5jbG9zZVBhdGgoKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNlbGVjdGlvbkxheWVyXG4iXX0=