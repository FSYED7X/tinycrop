'use strict';

/*
 * Modified version of http://github.com/desandro/imagesloaded v2.1.1
 * MIT License.
 */

var BLANK = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';

function imageLoaded(image, callback) {
  if (!image.nodeName || image.nodeName.toLowerCase() !== 'img') {
    return callback(new Error('First argument must an image element'));
  }

  if (image.src && image.complete && image.naturalWidth !== undefined) {
    return callback(null, true);
  }

  image.addEventListener('load', function () {
    callback(null, false);
  });

  image.addEventListener('error', function (e) {
    callback(new Error('Failed to load image \'' + (image.src || '') + '\''));
  });

  if (image.complete) {
    var src = image.src;
    image.src = BLANK;
    image.src = src;
  }
}

module.exports = imageLoaded;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbWFnZUxvYWRlZC5qcyJdLCJuYW1lcyI6WyJCTEFOSyIsImltYWdlTG9hZGVkIiwiaW1hZ2UiLCJjYWxsYmFjayIsIm5vZGVOYW1lIiwidG9Mb3dlckNhc2UiLCJFcnJvciIsInNyYyIsImNvbXBsZXRlIiwibmF0dXJhbFdpZHRoIiwidW5kZWZpbmVkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7OztBQUtBLElBQUlBLFFBQVEsd0VBQVo7O0FBRUEsU0FBU0MsV0FBVCxDQUFzQkMsS0FBdEIsRUFBNkJDLFFBQTdCLEVBQXVDO0FBQ3JDLE1BQUksQ0FBQ0QsTUFBTUUsUUFBUCxJQUFtQkYsTUFBTUUsUUFBTixDQUFlQyxXQUFmLE9BQWlDLEtBQXhELEVBQStEO0FBQzdELFdBQU9GLFNBQVMsSUFBSUcsS0FBSixDQUFVLHNDQUFWLENBQVQsQ0FBUDtBQUNEOztBQUVELE1BQUlKLE1BQU1LLEdBQU4sSUFBYUwsTUFBTU0sUUFBbkIsSUFBK0JOLE1BQU1PLFlBQU4sS0FBdUJDLFNBQTFELEVBQXFFO0FBQ25FLFdBQU9QLFNBQVMsSUFBVCxFQUFlLElBQWYsQ0FBUDtBQUNEOztBQUVERCxRQUFNUyxnQkFBTixDQUF1QixNQUF2QixFQUErQixZQUFZO0FBQ3pDUixhQUFTLElBQVQsRUFBZSxLQUFmO0FBQ0QsR0FGRDs7QUFJQUQsUUFBTVMsZ0JBQU4sQ0FBdUIsT0FBdkIsRUFBZ0MsVUFBVUMsQ0FBVixFQUFhO0FBQzNDVCxhQUFTLElBQUlHLEtBQUosQ0FBVSw2QkFBNkJKLE1BQU1LLEdBQU4sSUFBYSxFQUExQyxJQUFnRCxJQUExRCxDQUFUO0FBQ0QsR0FGRDs7QUFJQSxNQUFJTCxNQUFNTSxRQUFWLEVBQW9CO0FBQ2xCLFFBQUlELE1BQU1MLE1BQU1LLEdBQWhCO0FBQ0FMLFVBQU1LLEdBQU4sR0FBWVAsS0FBWjtBQUNBRSxVQUFNSyxHQUFOLEdBQVlBLEdBQVo7QUFDRDtBQUNGOztBQUVETSxPQUFPQyxPQUFQLEdBQWlCYixXQUFqQiIsImZpbGUiOiJpbWFnZUxvYWRlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBNb2RpZmllZCB2ZXJzaW9uIG9mIGh0dHA6Ly9naXRodWIuY29tL2Rlc2FuZHJvL2ltYWdlc2xvYWRlZCB2Mi4xLjFcbiAqIE1JVCBMaWNlbnNlLlxuICovXG5cbnZhciBCTEFOSyA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUlBQUFBQUFBUC8vL3l3QUFBQUFBUUFCQUFBQ0FVd0FPdz09J1xuXG5mdW5jdGlvbiBpbWFnZUxvYWRlZCAoaW1hZ2UsIGNhbGxiYWNrKSB7XG4gIGlmICghaW1hZ2Uubm9kZU5hbWUgfHwgaW1hZ2Uubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2ltZycpIHtcbiAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdGaXJzdCBhcmd1bWVudCBtdXN0IGFuIGltYWdlIGVsZW1lbnQnKSlcbiAgfVxuXG4gIGlmIChpbWFnZS5zcmMgJiYgaW1hZ2UuY29tcGxldGUgJiYgaW1hZ2UubmF0dXJhbFdpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgdHJ1ZSlcbiAgfVxuXG4gIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgY2FsbGJhY2sobnVsbCwgZmFsc2UpXG4gIH0pXG5cbiAgaW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBmdW5jdGlvbiAoZSkge1xuICAgIGNhbGxiYWNrKG5ldyBFcnJvcignRmFpbGVkIHRvIGxvYWQgaW1hZ2UgXFwnJyArIChpbWFnZS5zcmMgfHwgJycpICsgJ1xcJycpKVxuICB9KVxuXG4gIGlmIChpbWFnZS5jb21wbGV0ZSkge1xuICAgIHZhciBzcmMgPSBpbWFnZS5zcmNcbiAgICBpbWFnZS5zcmMgPSBCTEFOS1xuICAgIGltYWdlLnNyYyA9IHNyY1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaW1hZ2VMb2FkZWRcbiJdfQ==